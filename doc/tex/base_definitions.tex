\section{ОСНОВНЫЕ ПОНЯТИЯ ОБ АТАКАХ И ИХ ОБНАРУЖЕНИИ}

Рассмотрим основные термины и определения, касающиеся области компьютерных систем и атак на них

\textit{\textbf{Компьютерная атака}} --- это целенаправленное несанкционированное воздействие на информацию, на ресурс автоматизированной информационной системы или получение несанкционированного доступа к ним с применением программных или программно-аппаратных средств (в соответствии с ГОСТ Р 51275-2006) \cite{bib:gostAttack}.

Процесс функционирования компьютерной системы можно представить как последовательность событий, изменяющих состояние этой системы. С точки зрения информационной безопасности каждое событие можно представить как совокупность двух составляющих --- действия и адресата. Если существуют потенциально возможные действия, которые могут нанести ущерб системе, значит, существует угроза нарушения информационной безопасности. Угрозы могут быть различны в зависимости от конкретных условий эксплуатации системы. Любая последовательность связанных между собой действий нарушителя, которые приводят к реализации угрозы путём использования уязвимостей этой информационной системы, является компьютерной атакой.

Любые несанкционированные системные или сетевые действия на одной из компьютеров в любой из подсетей, целью которых является нарушение политики безопасности, являются атакой на данную систему.

Существуют различные классификации атак. К основным факторам, которые влияют на клиссификацию атак, можно отнести:

\begin{itemize}

\item взаимное расположение атакующего и атакуемого объекта, то есть наличие или отсутствие у нарушителя физического доступа к атакуемой системе

\item атакуемый ресурс --- узел, сеть, линии связи, приложение, база данных и т.д.

\item целевое воздействие на ресурс и уровень потенциального ущерба от атаки

\end{itemize}

Кроме того, многие атаки могут производиться не одним нарушителем, а множеством, что позволяет добавить ещё один фактор --- распределённость атаки.

В зависимости от наличия физического доступа к системе выделяют \cite{bib:phys_attack_types}:

\begin{itemize}

\item локальные атаки --- попытки получения доступа к информации или к управлению при наличии непосредственного доступа к системе

\item удалённые атаки --- попытки получения доступа к информации или управлению без непосредственного доступа к системе, а через каналы связи другой системы

\item атаки на каналы связи --- попытки получения доступа к информации или управлению системами в процессе передачи данных по каналам связи между системами

\item атаки с отслеживанием побочных электромагнитных излучений ЭВМ --- реализуются с применением средств спецтехники

\end{itemize}

В зависимости от цели атаки выделяют:

\begin{itemize}

\item <<удалённое проникновение>>, <<Remote-To-Local>>, <<R2L>> --- целью является получение управления удалённой системой (относится к удалённым атакам)

\item <<локальное проникновение>>, <<User-To-Root>>, <<U2R>>, в том числе взлом паролей --- целью является получение управления на локальной системе, превышающего полномочия данного субъекта (относится к локальным атакам)

\item <<удалённый отказ в обслуживании>>, <<remote Denial of service>>, <<DoS>> --- целью является нарушение функционирования системы или перегрузка компьютера, на котором она реализуется (относится к локальным атакам)

\item сетевое сканирование, сканирование уязвимостей, <<Probing>> - целью является получение информации о топологии вычислительное сети и уязвимых сервисах, доступных для атаки (относятся к удалённым атакам или атакам на каналы связи). Выделяется в отдельных класс, несмотря на то, что является по сути сбором исходных данных для последующей реализации других атак: так как информация о внутренней организации сети является конфиденциальной, получение информации о ней посторонним субъектом уже само по себе является атакой

\item перехват сетевого траффика --- <<прослушивание>> траффика с целью поиска идентфикаторов и паролей пользователей, другой конфиденциальное инофрмации (относится к атакам на каналы связи). Стоит отметить, что практически все средства защиты информации используют перехват траффика в собственных целях, поэтому нужно различать --- кто и с какой целью <<прослушивает>> сеть

\end{itemize}

\textit{\textbf{Сетевая атака}} --- это компьютерная атака с использованием протоколов межсетевого взаимодействия (в соответствии с ГОСТ Р 51275-2006) \cite{bib:gostAttack}.

Согласно приведенным выше классификациям, к сетевым атакам в первую очередь стоит отнести удалённые атаки и атаки на каналы связи. Однако, некоторые локальные атаки также могут производиться с использованием сетевых средств системы.

Сетевые атаки могут производиться на любом из уровней эталонной модели взаимодействия открытым систем OSI. Атаки на физическом и канальном уровнях из-за специфики можно не рассматривать при создании методов обнаружения сетевых атак. Противодействие данным атакам должно производиться при помощь оборудования, функционирующего на этих уровнях. Обнаружение атак на остальных пяти уровнях модели --- начиная с сетевого и заканчивая прикладным --- это и есть задача системы обнаружения атак.

\textit{\textbf{Система обнаружения атак}}, или \textit{\textbf{система обнаружения вторжений}} --- это система, осуществляющая сбор информации с множества системных и сетевых источников, анализирующая полученную информацию на предмет признаков вторжений (атак) \cite{bib:ids}. Соответствует английскому термину \textit{Intrusion Detection System}.

СОА отличаются от других средств обеспечения сетевой безопасности, например, межсетевых экранов или антивирусного ПО. Занимаясь анализом поведения субъекта системы либо анализом сетевого трафика, СОА может обнаружить признаки атаки, производимой при помощь легальных для данной системы средств --- соединений через открытые порты, незараженных вирусами программ, и даже аномального поведения пользователя, не похожего на его обычное поведение в информационной системе. Поэтому СОА являются необходимым элементов обеспечения безопасности компьютерной системы.

Практически любую компьютерную атаку можно обнаружить <<постфактум>> путём анализа экспертом журналов регистрации событий безопасности --- ОС, СУБД, прикладных программ и т.д. Тем самым снижаются затраты на развёртывание и обеспечение функционирования инфраструктуры обнаружения атак. Однако, временные затраты на осуществление данного процесса возрастут многократно, что в итоге не позволит оперативно реагировать на нарушения политики безопасности и тем более предотвращать их. С этой целью и создаются специализированные средства обнаружения атак.

Можно определить главные задачи системы защиты информации.

\begin{enumerate}

\item Система должна каччественно выполнять возложенные на неё функции --- обнаруживать и распознавать как известные, так и неизвестные атаки, а также сообщать об этом надлежащим образом

\item Снижение нагрузки на персонал за счёт автоматического контроля действий в информационной системе. Персонал оставляет за собой ответственность за управлением функционированием системы защиты информации и выполняет мероприятия по реагированию на обнаруженные атаки

\end{enumerate}


\section{ПОСТАНОВКА ЗАДАЧИ}

Традиционно, наиболее использумыми методами для автоматического обнаружения атак являются сигнатурные методы. Эти методы выделяют ключевые признаки из сетевого трафика, и обнаружение происходит путём сравнения этих признаков согласно списка сигнатур атак, предоставляемых экспертами. Очевидно, такие методы не имеют возможности обнаружения новых типов атак, потому что для этого необходимо наличие соответствующего этой атаке сигнатурного правила. База данных, содержащие такие правила, должна поддерживаться вручную и обновляться по мере появление новых известных атак. Другие подходы используют data mining и алгоритмы машинного обучения для обучения на помеченных сетевых данных (т.е. на экзэмплярах сетевой активности, помеченных метками <<атака>> или <<не атака>>).

Подход, использующий обнаружение аномалий, обычно оперирует над моделью <<нормальных>> данных и в последующем пытается обнаружить отклонения от <<нормальной>> модели исследуемых данных. Алгоритмы обнаружения аномалий имеют преимущество в том, что могут обнаруживать новый типы атак, т.к. новые атаки, по предположению, будут отклоняться от нормального сетевого поведения. Традиционно алгоритмы обнаружения аномалий требуют наличия абсолютно чистых сетевых данных, на базе которых происходит обучение их модели. Если же окажется, что данные содержат какие-то атаки, алгоритм может не распознать эти типы атак, посчитав их нормальными.

Чаще всего таких данных не существует, как и не всегда просто найти заранее помеченные данные, для которых известно где производилась атака, а где нет. В общем случае приходится иметь дело с огромными объёмами сетевых данных, в связи с чем становится сложно реализуемой возможность ручной классификации этих данных. Можно сгенерировать помеченные данные, имитируя атаки, но в таком случае у нас будут данные только для заранее известных типов атак. И мы столкнёмся с тем же недостатком обнаружения, которым обладают сигнатурные методы --- невозможность обнаружения новых типов атак. Более, если и предположить возможность ручной классификации данных, всё равно мы ограничены возможностью обнаружения только заданных типов атак, тем самым сокращая возможности системы. Генерация абсолютно чистых от атак данных сложно реализуема на практике. При сборе <<сырых>> данных из сети, нельзя гарантировать, что во время сбора не было произведено каких-либо атак в сети.

В этой работе будет сделана попытка реализовать новый тип алгоритма обнаружения атак с целью избежать сложностей и недостатков представленных выше подходов. На вход алгоритму поступают заранее неизвестные сетевые данные и в них производится поиск на наличие атак. О данных делается 2 предположения, которые лежат в основе возможности реализации и корректности такого алгоритма. Первое предположение состоит в том, что число нормальных данных намного больше данных с атаками. Второе предположение --- атаки качественно отличаются от нормальных данных. Основная идея состоит в том, что благодаря редкости и качественному отличию атак, на фоне всех данных они будут представлять своего рода выбросы. На основании чего и будут обнаружены. 

\subsection{ФОРМАЛЬНАЯ ПОСТАНОВКА ЗАДАЧИ}


Положим $X = \left\{x_1, x_2, ..., x_n\right\} $ - множество узлов в компьютерной сети.

Пусть каждый узел $x_i \in X$ в момент времени $t \in T$ характеризуется \textit{состоянием} $S(x_i, t)$.

\textit{Состоянием} сети $S(X, t)$ будем называть множество состояний её узлов в момент времени $t$
\begin{equation*}
S(X, t) = \left\{S(x_i, t) | x_i \in X\right\}
\end{equation*}


Будем считать, что узлы взаимодействуют между собой посредством передачи сообщений, используя сетевой протокол. Тогда положим $m(x_i, x_j)$ - управляющая информация от объекта $x_i$ к $x_j$. Назовём \textit{переходом} изменение состояния узла в результате взаимодействия с участием этого узла. 

Введём множества состояний $A$ и $N$ (от. Attack и Normal соответственно).

$A$ - множество состояний узлов, каждое из которых представляет состояние узла после произведения над ним какой-либо компьютерной атаки, или другими словами множество всевозможных опасных состояний узлов

$N$ - множество нормальных состояний узлов.

Состояние сети будем называть \textit{опасным}, если состояние хотя бы одного узла в этой сети принадлежит множеству $A$.

Таким образом для обнаружения атак в такой сети достаточно наблюдать за состояниями узлов этой сети, а точнее за изменением состояний этих узлов. 

В рамках данной работы будем предполагать, что состояния узлов изменяются только в результате взаимодействия узлов между собой (ввиду того, что предметом исследования являются атаки на компьютерные сети). А поэтому можно ввести множества $M_A$ и $M_N$ -- соответственно множества описаний объектов $m(x_i, x_j)$ потоков информации, приводящих узлы в в опасные и нормальные состояния.


Зафиксируем узел сети $x \in X$. 
Пусть в момент времени $t$ произошло взаимодействие узлов $x$ и $y$ в сети, в результате которого на узел $x$ поступила управляющая информация $I$. В ответ на это узел $x$ выполняет действия, которые в дальнейшем будем называть \textit{реакцией} узла и обозначать $R = f(I)$, где $f$ - функция реагирования с областью определения $D(f)$~--\{множество всех возможных входов\}. По сути эта функция реализована в виде механизма работы конкретного узла $x$ сети и вообще говоря может отличаться для разных узлов. Она и реализует смену состояний узла $x \in X$.

Формальная постановка задачи обнаружения атак в компьютерной сети:

Пусть задано множество $M_{tr} = \left\{m(x_i, x_j)\right\}$ описаний взаимодействий узлов $x_i$ и $x_j$ сети, где $m(x_i, x_j)$ можно описать в виде набора признаков $(x_1, x_2, ..., x_n)$.


Множество $M_{tr}$ будем называть обучающим множеством.

Про множество $M_{tr}$ известно, что подмножество аномальных взаимодействий 
$M_{tr_A} \in M_{tr}$ по мощности мало сравнимо с мощностью множества 
нормальных взаимодействий $M_{tr_T} \in M_{tr}$ 
(составляет не более 1-1.5 \% от общей мощности множества $M_{tr}$). 


Собственно сама постановка задачи:
$\forall m(x_i, x_j)$ определить $m(x_i, x_j) \in M_A$ 
или $m(x_i, x_j) \in M_N$, т.е. для любого 
взаимодействия $m(x_i, x_j)$ в сети определить, 
является оно аномальным (несущим угрозу) или нормальным.